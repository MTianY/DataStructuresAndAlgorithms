# 回溯

通过选择不同岔路口通往目的地

## 八皇后问题

在 8*8 格的国际象棋上摆放八个皇后, 使其不能互相攻击. 任意两个皇后都不能处于同一行、同一列或同一斜线上. 请问有多少种摆法?

皇后攻击范围:

- 同一行, 同一列或同一对角线都是其攻击范围.

### 四皇后 - 回溯法

4 * 4 棋盘. 先选一个格子, 第二个棋子再下面接着选, 直到尽头选不了格子之后, 往回走, 重新再选.

1.


|  |  |  |  |
| :-: | :-: | :-: | :-: |
|  |  |  |  |
|  |  |  |  |
|  |  |  |  |

2.

Q1棋子先放第一格, X 位置皆为攻击范围, 不能继续摆放棋子.

| Q1 | X | X | X |
| :-: | :-: | :-: | :-: |
| X | X |  |  |
| X |  | X |  |
| X |  |  | X |

3.

摆放 Q2 棋子之后, 只剩下一个格子可以放棋子, 不满足要求, 开始回溯到第 2 步.

| Q1 | X | X | X |
| :-: | :-: | :-: | :-: |
| X | X | Q2 | X |
| X | X | X | X |
| X |  | X | X |

4.

回溯到了第 2 步, 重新摆放 Q2 棋子. 此时剩下两个格子, 继续摆放 Q3 棋子.

| Q1 | X | X | X |
| :-: | :-: | :-: | :-: |
| X | X | X | Q2 |
| X |  | X | X |
| X | X |  | X |

5.

摆放 Q3 棋子之后, 没有格子可以摆放 Q4, 不满足条件, 继续回溯, 上面已经回溯到过第 2 步, 所以这次回溯到第 1 步,重新摆放 Q1.

| Q1 | X | X | X |
| :-: | :-: | :-: | :-: |
| X | X | X | Q2 |
| X | Q3 | X | X |
| X | X | X | X |

6.

回溯到了第 1 步, 重新摆放 Q1 棋子. 摆到第一行第 2 个格子上.

| X | Q1 | X | X |
| :-: | :-: | :-: | :-: |
| X | X | X |  |
|   | X |   | X |
|   | X |   |   |

7.

继续摆放 Q2 棋子.

| X | Q1 | X | X |
| :-: | :-: | :-: | :-: |
| X | X | X | Q2 |
|   | X | X | X |
|   | X |   |  X |

8.

继续摆放 Q3 棋子

| X | Q1 | X | X |
| :-: | :-: | :-: | :-: |
| X | X | X | Q2 |
| Q3 | X | X | X |
| X | X |   |  X |

9.

继续摆放 Q4 棋子

| X | Q1 | X | X |
| :-: | :-: | :-: | :-: |
| X | X | X | Q2 |
| Q3 | X | X | X |
| X | X | Q4 |  X |


### 四皇后 - 剪枝

以 Q1 为例, 当第一行一个列摆放 Q1 后, 第二行的第一列和第二列可以剔除. 不考虑此情况. 那么第二行前两列衍生出的情况也不用考虑.

| Q1 | X | X | X |
| :-: | :-: | :-: | :-: |
| X | X |  |  |
| X |  | X |  |
| X |  |  | X |

### 实现方案

采用递归方式. 以行为单位.

